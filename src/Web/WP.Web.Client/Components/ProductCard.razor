@using WP.Web.Client.Models

<div class="card h-100 product-card">
    @if (!string.IsNullOrEmpty(Product.Image))
    {
        <img src="@Product.Image" class="card-img-top product-image" alt="@Product.Name" 
             onerror="this.src='https://via.placeholder.com/300x200?text=No+Image'" />
    }
    else
    {
        <img src="https://via.placeholder.com/300x200?text=No+Image" class="card-img-top product-image" alt="No image" />
    }
    <div class="card-body d-flex flex-column">
        <h5 class="card-title">@Product.Name</h5>
        <p class="card-text text-muted small">@Product.Description</p>
        <div class="mt-auto">
            <div class="d-flex justify-content-between align-items-center mb-2">
                <span class="h4 mb-0 text-primary">$@Product.Value.ToString("F2")</span>
                <span class="badge @(Product.Active ? "bg-success" : "bg-secondary")">
                    @(Product.Active ? "Active" : "Inactive")
                </span>
            </div>
            <div class="d-flex justify-content-between text-muted small mb-3">
                <span><i class="bi bi-box-seam"></i> Stock: @Product.StockQuantity</span>
                <span><i class="bi bi-calendar3"></i> @Product.RegisterDate.ToString("dd/MM/yyyy")</span>
            </div>
            @if (ShowActions)
            {
                <div class="btn-group w-100" role="group">
                    <button class="btn btn-sm btn-outline-primary" @onclick="() => OnView.InvokeAsync(Product.Id)">
                        <i class="bi bi-eye"></i> View
                    </button>
                    <button class="btn btn-sm btn-outline-secondary" @onclick="() => OnEdit.InvokeAsync(Product.Id)">
                        <i class="bi bi-pencil"></i> Edit
                    </button>
                    <button class="btn btn-sm btn-outline-danger" @onclick="() => OnDelete.InvokeAsync(Product.Id)">
                        <i class="bi bi-trash"></i> Delete
                    </button>
                </div>
            }
        </div>
    </div>
</div>

<style>
    .product-card {
        transition: transform 0.2s, box-shadow 0.2s;
        border: 1px solid #dee2e6;
    }

    .product-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }

    .product-image {
        height: 200px;
        object-fit: cover;
        border-bottom: 1px solid #dee2e6;
    }

    .card-text {
        overflow: hidden;
        text-overflow: ellipsis;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
    }
</style>

@code {
    [Parameter, EditorRequired]
    public ProductDto Product { get; set; } = null!;

    [Parameter]
    public bool ShowActions { get; set; } = true;

    [Parameter]
    public EventCallback<Guid> OnView { get; set; }

    [Parameter]
    public EventCallback<Guid> OnEdit { get; set; }

    [Parameter]
    public EventCallback<Guid> OnDelete { get; set; }
}
